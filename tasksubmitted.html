<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Tasquirre – Task Submitted</title>
<link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet" />

<style>
:root {
  --bg: #fff6e6;
  --bg-soft: #ffe8c7;
  --round-soft: #f1d2b2;
  --text-main: #5a2c13;
  --text-sub: #a96b3d;
  --accent: #c5652c;
  --accent-deep: #824119;
  --border-soft: #f0d4af;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:"Poppins",sans-serif}

body{
  background:var(--bg);
  display:flex;
  justify-content:center;
  align-items:flex-start;
  min-height:100vh;
  padding:1.5rem 0;
}

.screen{
  width:100%;
  max-width:428px;
  min-height:100vh;
  background:var(--bg);
  padding-bottom:2.4rem;
  overflow-y:auto;
  transition:opacity .45s ease,filter .45s ease;
}

.screen.fade-out{
  opacity:0;
  filter:blur(10px);
}

/* HEADER */
.app-header{
  display:flex;
  align-items:center;
  gap:0.6rem;
  padding:0.8rem 1.1rem;
}

.back-btn{
  width:42px;height:42px;
  display:flex;
  justify-content:center;align-items:center;
  background:var(--round-soft);
  border:none;
  border-radius:50%;
  font-size:1.3rem;
  cursor:pointer;
  color:var(--accent);
}

.header-title{
  font-size:1.15rem;
  font-weight:700;
  color:var(--accent);
}

/* CARD */
.card{
  background:#fff;
  margin:0.4rem 1.1rem 1.1rem;
  padding:1.1rem;
  border-radius:18px;
  box-shadow:0 6px 16px rgba(0,0,0,.08);
}

.job-title{
  font-size:1.05rem;
  font-weight:600;
  color:var(--text-main);
  margin-bottom:0.4rem;
}

.label{
  font-size:0.78rem;
  color:var(--text-sub);
  margin-bottom:3px;
}

.value{
  font-size:0.95rem;
  color:var(--text-main);
  font-weight:500;
}

.status-chip{
  display:inline-block;
  margin-top:0.6rem;
  padding:0.3rem 0.75rem;
  border-radius:999px;
  background:rgba(255,237,173,.85);
  color:#8c5a12;
  font-size:0.78rem;
}

/* PROGRESS */
.progress-wrap{
  margin-top:0.8rem;
}

.progress-top{
  display:flex;
  justify-content:space-between;
  font-size:0.8rem;
  color:var(--text-sub);
}

.progress-bar{
  width:100%;
  height:10px;
  background:#ffe8c7;
  border-radius:999px;
  overflow:hidden;
  margin-top:0.4rem;
}

.progress-fill{
  height:10px;
  background:linear-gradient(90deg,#c5652c,#824119);
  width:100%;
}

/* DESCRIPTION */
.info-text{
  margin-top:0.9rem;
  font-size:0.82rem;
  color:var(--text-sub);
  line-height:1.5;
}

/* BUTTONS */
.btn-row{
  display:flex;
  flex-direction:column;
  gap:0.6rem;
  margin-top:1.1rem;
}

.btn-pill{
  width:100%;
  padding:0.65rem 0;
  border-radius:999px;
  border:none;
  font-size:0.85rem;
  font-weight:600;
  cursor:pointer;
}

.btn-primary{
  background:linear-gradient(145deg,#c5652c,#f4984a);
  color:#fff;
}

.btn-secondary{
  background:#fff;
  border:1.4px solid var(--accent);
  color:var(--accent);
}

/* TOAST */
.toast-popup{
  position:fixed;
  top:-80px;
  left:50%;
  transform:translateX(-50%);
  background:rgba(197,82,43,.92);
  padding:13px 18px;
  border-radius:18px;
  color:#fff;
  opacity:0;
  transition:.45s ease;
  z-index:9999;
}
.toast-popup.show{
  top:90px;
  opacity:1;
}
</style>
</head>
<body>

<div id="toast" class="toast-popup">Action</div>

<div class="screen" id="frame">

  <header class="app-header">
    <button class="back-btn" onclick="goBack()">
      <i class="bx bx-arrow-back"></i>
    </button>
    <div class="header-title">Task Submitted</div>
  </header>

  <div class="card" id="cardTask">
    <!-- JS -->
  </div>

</div>

<script>
function showToast(msg){
  const t=document.getElementById("toast");
  t.textContent=msg;
  t.classList.add("show");
  setTimeout(()=>t.classList.remove("show"),1700);
}

function seedPartnerTaskIfEmpty(){
  let t = localStorage.getItem("partnerTaskTasquirre");
  if(!t){
    const demo = {
      id:"TSQ-X71P9",
      jobdesk:"Copywriting 2 halaman A4",
      user:"Teresa",
      price:80000,
      status:"submitted",
      progress:100,
      createdAt:Date.now()
    };
    localStorage.setItem("partnerTaskTasquirre", JSON.stringify(demo));
    return demo;
  }
  return JSON.parse(t);
}

let task = seedPartnerTaskIfEmpty();
if(task.progress<100){
  task.progress = 100;
  task.status = "submitted";
  localStorage.setItem("partnerTaskTasquirre", JSON.stringify(task));
}

function render(){
  task = seedPartnerTaskIfEmpty();
  const card = document.getElementById("cardTask");

  card.innerHTML = `
    <div class="job-title">${task.jobdesk}</div>

    <div style="margin-bottom:0.6rem;">
      <div class="label">Client</div>
      <div class="value">${task.user}</div>
    </div>

    <div style="margin-bottom:0.6rem;">
      <div class="label">Fee</div>
      <div class="value">Rp ${Number(task.price||0).toLocaleString("id-ID")}</div>
    </div>

    <div style="margin-bottom:0.6rem;">
      <div class="label">Task ID</div>
      <div class="value">${task.id}</div>
    </div>

    <span class="status-chip">Menunggu Konfirmasi User</span>

    <div class="progress-wrap">
      <div class="progress-top">
        <span>Progress</span>
        <span>100%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill"></div>
      </div>
    </div>

    <p class="info-text">
      Kamu sudah mengirim hasil kerja kepada user. Setelah user menekan
      <strong>Konfirmasi Selesai</strong> di sisi mereka, saldo akan otomatis
      masuk ke dompet Tasquirre-mu.
    </p>

    <div class="btn-row">
      <button class="btn-pill btn-primary" onclick="simulateConfirm()">
        Simulasikan Konfirmasi User (Demo)
      </button>

      <button class="btn-pill btn-secondary" onclick="openChat()">
        Chat dengan User
      </button>
    </div>
  `;
}

function simulateConfirm(){
  task = seedPartnerTaskIfEmpty();

  // ubah status jadi completed
  task.status = "completed";
  localStorage.setItem("partnerTaskTasquirre", JSON.stringify(task));

  
  // tambahkan saldo (demo)
  let saldo = Number(localStorage.getItem("saldoTasquirre") || 0);
  saldo += Number(task.price||0);
  localStorage.setItem("saldoTasquirre", saldo);

  showToast("Task selesai • Saldo bertambah");

  setTimeout(()=>{
    const f=document.getElementById("frame");
    f.classList.add("fade-out");
    setTimeout(()=>window.location.href=`confirmfinish.html?id=${encodeURIComponent(task.id)}`,450);
  },900);
}

function goBack(){
  const f=document.getElementById("frame");
  f.classList.add("fade-out");
  setTimeout(()=>window.location.href="activitiespartner.html",450);
}

function openChat(){
  const f=document.getElementById("frame");
  f.classList.add("fade-out");
  setTimeout(()=>window.location.href=`chatpartner.html?id=${encodeURIComponent(task.id)}`,450);
}

render();
</script>
</body>
</html>
